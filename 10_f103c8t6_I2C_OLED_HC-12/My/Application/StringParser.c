/*
 * StringParser.c
 *
 *  Created on: 13 окт. 2022 г.
 *      Author: belyaev
 */
//*******************************************************************************************
//*******************************************************************************************

#include "StringParser.h"

//*******************************************************************************************
//*******************************************************************************************
char buf[SIZE_RECEIVE_BUF];
char *argv[AMOUNT_PAR];

static uint8_t argc = 0;
static uint8_t i 	= 0;
static uint8_t flag = 0;
//*******************************************************************************************
//*******************************************************************************************
void PARS_Init(void){

	argc 	= 0;
	argv[0] = buf;
	flag 	= FALSE;
	i 		= 0;
}
//**********************************************************
void PARS_Parser(char sym){

	//---------------------
	if(sym != '\r')
	{
		if(i < SIZE_RECEIVE_BUF - 1)
		{
			if(sym != ' ')
			{
				//---------------------
				if(!argc)
				{
					argv[0] = buf;
					argc++;
				}
				//---------------------
				if(flag)
				{
					if(argc < AMOUNT_PAR)
					{
						argv[argc] = &buf[i];
						argc++;
					}
					flag = FALSE;
				}
				//---------------------
				buf[i] = sym;
				i++;
			}
			else
			{
				//---------------------
				if(!flag)
				{
					buf[i] = 0;
					i++;
					flag = TRUE;
				}
				//---------------------
			}
		}
		buf[i] = 0;
		return;
	}
	//---------------------
	else
	{
		buf[i] = 0;

		if (argc) PARS_Handler(argc, argv);
		else
		{
			//сюда можно что-то добавить
		}

		argc = 0;
		i 	 = 0;
		flag = FALSE;
	}
	//---------------------
}
//**********************************************************
uint32_t PARS_EqualStr(char *s1, char *s2){

	uint32_t i = 0;
	//---------------------
	//Сравниваем и счистаем символы
	while(s1[i] == s2[i] &&
		  s1[i] != '\0'  &&
		  s2[i] != '\0')
	{
		i++;
	}
	if (s1[i] =='\0' && s2[i] == '\0') return TRUE;
	else							   return FALSE;
}
//**********************************************************
uint8_t PARS_StrToUchar(char *s){

	uint8_t value = 0;
	//---------------------
	while(*s == '0') s++;
	while(*s)
	{
		value += (*s - 0x30);
		s++;
		if(*s) value *= 10;
	}
	return value;
}
//**********************************************************
uint32_t PARS_StrToUint(char *s){

	uint32_t value = 0;
	//---------------------
	while(*s == '0') s++;
	while(*s)
	{
		value += (*s - 0x30);
		s++;
		if(*s) value *= 10;
	}
	return value;
}
//*******************************************************************************************
//*******************************************************************************************

//**********************************************************


//*******************************************************************************************
//*******************************************************************************************


