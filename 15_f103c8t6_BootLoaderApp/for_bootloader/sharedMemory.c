/*
 *  sharedMemory.c
 *
 *  Created on: 29 мар. 2023 г.
 *      Author: belyaev
 */
//*******************************************************************************************
//*******************************************************************************************

#include "sharedMemory.h"

//*******************************************************************************************
//*******************************************************************************************
const  uint32_t SHARED_MEM_MAGIC = 0xbadcafe;
static sharedMemory_t sharedMemory __attribute__((section(".shared_memory")));

//*******************************************************************************************
//*******************************************************************************************
//*******************************************************************************************
//*******************************************************************************************
void SharedMemory_Init(void){

	//Если первое включение, то инициализация
    if(sharedMemory.magic != SHARED_MEM_MAGIC)
    {
        memset(&sharedMemory, 0, sizeof(sharedMemory_t));
        sharedMemory.magic = SHARED_MEM_MAGIC;
    }
}
//**********************************************************
uint32_t SharedMemory_GetFlags(void){

	return sharedMemory.flags;
}
//**********************************************************
void SharedMemory_SetFlag(uint32_t flag){

	sharedMemory.flags |= flag;
}
//**********************************************************
void SharedMemory_ClearFlag(uint32_t flag){

	sharedMemory.flags &= ~flag;
}
//**********************************************************
void SharedMemory_IncrementBootCounter(void){

	sharedMemory.boot_counter++;
}
//**********************************************************
void SharedMemory_ClearBootCounter(void){

	sharedMemory.boot_counter = 0;
}
//**********************************************************
uint32_t SharedMemory_GetBootCounter(void){

    return sharedMemory.boot_counter;
}
//*******************************************************************************************
//*******************************************************************************************
//*******************************************************************************************
//*******************************************************************************************








